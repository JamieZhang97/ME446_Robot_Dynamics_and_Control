function [dJ4] = fcn_dJ4(q,dq,p)

dJ4 = zeros(3,3);

  dJ4(1,1)=dq(2)*(p(3)*(cos(q(2))*sin(q(1))*sin(q(3)) + cos(q(3))*sin(q(1))*sin(q(2))) + p(2)*...
         sin(q(1))*sin(q(2))) - dq(1)*(p(3)*(cos(q(1))*cos(q(2))*cos(q(3)) - cos(q(1))*sin(q(2))*sin(q(3))) + p(2)*...
         cos(q(1))*cos(q(2))) + dq(3)*p(3)*(cos(q(2))*sin(q(1))*sin(q(3)) + cos(q(3))*sin(q(1))*sin(q(2)));
  dJ4(1,2)=dq(1)*(p(3)*(cos(q(2))*sin(q(1))*sin(q(3)) + cos(q(3))*sin(q(1))*sin(q(2))) + p(2)*...
         sin(q(1))*sin(q(2))) - dq(2)*(p(3)*(cos(q(1))*cos(q(2))*cos(q(3)) - cos(q(1))*sin(q(2))*sin(q(3))) + p(2)*...
         cos(q(1))*cos(q(2))) - dq(3)*p(3)*(cos(q(1))*cos(q(2))*cos(q(3)) - cos(q(1))*sin(q(2))*sin(q(3)));
  dJ4(1,3)=dq(1)*p(3)*(cos(q(2))*sin(q(1))*sin(q(3)) + cos(q(3))*sin(q(1))*sin(q(2))) - dq(3)*p(3)*...
         (cos(q(1))*cos(q(2))*cos(q(3)) - cos(q(1))*sin(q(2))*sin(q(3))) - dq(2)*p(3)*(cos(q(1))*cos(q(2))*...
         cos(q(3)) - cos(q(1))*sin(q(2))*sin(q(3)));
  dJ4(2,1)=dq(1)*(p(3)*(sin(q(1))*sin(q(2))*sin(q(3)) - cos(q(2))*cos(q(3))*sin(q(1))) - p(2)*...
         cos(q(2))*sin(q(1))) - dq(2)*(p(3)*(cos(q(1))*cos(q(2))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2))) + p(2)*...
         cos(q(1))*sin(q(2))) - dq(3)*p(3)*(cos(q(1))*cos(q(2))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2)));
  dJ4(2,2)=dq(2)*(p(3)*(sin(q(1))*sin(q(2))*sin(q(3)) - cos(q(2))*cos(q(3))*sin(q(1))) - p(2)*...
         cos(q(2))*sin(q(1))) - dq(1)*(p(3)*(cos(q(1))*cos(q(2))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2))) + p(2)*...
         cos(q(1))*sin(q(2))) + dq(3)*p(3)*(sin(q(1))*sin(q(2))*sin(q(3)) - cos(q(2))*cos(q(3))*sin(q(1)));
  dJ4(2,3)=dq(2)*p(3)*(sin(q(1))*sin(q(2))*sin(q(3)) - cos(q(2))*cos(q(3))*sin(q(1))) - dq(1)*p(3)*...
         (cos(q(1))*cos(q(2))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2))) + dq(3)*p(3)*(sin(q(1))*sin(q(2))*...
         sin(q(3)) - cos(q(2))*cos(q(3))*sin(q(1)));
  dJ4(3,1)=0;
  dJ4(3,2)=dq(2)*(p(3)*(cos(q(2))*sin(q(3)) + cos(q(3))*sin(q(2))) + p(2)*sin(q(2))) + dq(3)*p(3)*...
         (cos(q(2))*sin(q(3)) + cos(q(3))*sin(q(2)));
  dJ4(3,3)=dq(2)*p(3)*(cos(q(2))*sin(q(3)) + cos(q(3))*sin(q(2))) + dq(3)*p(3)*(cos(q(2))*...
         sin(q(3)) + cos(q(3))*sin(q(2)));

 